---
name: code_analysis
description: 分析代码逻辑，解释功能，识别问题
version: "1.0"
tools:
  - python_exec
  - Read
  - Glob
  - Bash
triggers:
  keywords: ["代码", "分析", "调试", "理解", "解读", "这段代码", "什么意思", "bug", "debug", "源码"]
resources: []
---

## 代码分析技能

### 分析维度
1. **功能理解**: 代码做什么
2. **逻辑分析**: 怎么实现的
3. **数据流**: 数据如何流转
4. **问题识别**: 潜在的 bug 或改进点
5. **复杂度评估**: 时间/空间复杂度

### 分析流程
1. 阅读代码整体结构
2. 识别入口点和主要函数
3. 逐步追踪执行流程
4. 注释关键逻辑
5. 指出问题和建议

### 代码审查清单
- [ ] 边界条件处理
- [ ] 错误处理是否完善
- [ ] 空值/空集合检查
- [ ] 资源是否正确释放
- [ ] 并发安全性
- [ ] 性能瓶颈
- [ ] 代码重复
- [ ] 命名是否清晰

### 输出格式
```
【代码概览】
整体功能: 一句话描述
语言/框架: ...
代码行数: ...

【核心逻辑】
```python
# 带注释的关键代码
def main_function():
    # 步骤 1: 初始化
    ...
    # 步骤 2: 处理数据
    ...
```

【执行流程】
1. 入口点: main() / handler()
2. 步骤 1: 描述
3. 步骤 2: 描述
4. 返回结果

【数据流】
输入 → 处理 1 → 处理 2 → 输出

【复杂度分析】
- 时间复杂度: O(n)
- 空间复杂度: O(1)

【潜在问题】（如有）
1. 问题: 描述
   位置: 第 X 行
   风险: 高/中/低
   建议: 如何修复

【改进建议】（如有）
1. 建议: 描述
   原因: 为什么这样更好
   示例: 改进后的代码
```

### 常见代码问题
- 硬编码的魔法数字
- 过长的函数
- 深层嵌套
- 缺少错误处理
- 资源泄漏
- SQL 注入风险
- 未验证的用户输入
